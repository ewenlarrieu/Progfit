# Progfit Backend API

Backend pour l'application Progfit - Plateforme de suivi de programmes sportifs.

## ğŸš€ Installation et dÃ©marrage

### PrÃ©requis

- Node.js (v18+)
- MongoDB
- Gmail avec mot de passe d'application

### Installation

```bash
npm install
```

### Configuration

CrÃ©ez un fichier `.env` avec :

```env
PORT=5000
MONGO_URL=votre-url-mongodb
JWT_SECRET=votre-secret-jwt
EMAIL_USER=votre-email@gmail.com
EMAIL_PASS=votre-mot-de-passe-app
CLIENT_URL=http://localhost:3000
```

### DÃ©marrage

```bash
npm start
```

Le serveur tourne sur `http://localhost:5000`

## ğŸ“‹ API Documentation

### ğŸ” Authentification

#### Inscription

**POST** `/api/auth/register`

**Body (JSON) :**

```json
{
  "username": "John Doe",
  "email": "john@example.com",
  "password": "MonMotDePasse123!"
}
```

**RÃ©ponse succÃ¨s (201) :**

```json
{
  "message": "Compte crÃ©Ã© avec succÃ¨s ! VÃ©rifiez votre email pour activer votre compte.",
  "user": {
    "id": "64f1234567890abcdef",
    "nom": "John Doe",
    "email": "john@example.com",
    "emailVerified": false
  }
}
```

**Erreurs possibles :**

- `400` : Champs manquants, format email invalide, mot de passe faible, email dÃ©jÃ  utilisÃ©
- `500` : Erreur serveur ou envoi email

**Validation mot de passe :**

- Minimum 8 caractÃ¨res
- Au moins 1 majuscule
- Au moins 1 minuscule
- Au moins 1 chiffre
- Au moins 1 caractÃ¨re spÃ©cial

#### VÃ©rification Email

**GET** `/api/auth/verify-email/:token`

**ParamÃ¨tres :**

- `token` : Token reÃ§u par email

**RÃ©ponse succÃ¨s (200) :**
Page HTML avec confirmation + token JWT

**Erreurs possibles :**

- `400` : Token invalide, expirÃ© ou compte dÃ©jÃ  vÃ©rifiÃ©

## ğŸ”§ Test avec Insomnia/Postman

### 1. Test d'inscription

```
POST http://localhost:5000/api/auth/register
Content-Type: application/json

{
  "username": "Test User",
  "email": "test@example.com",
  "password": "TestPass123!"
}
```

### 2. VÃ©rification email

1. VÃ©rifiez votre boÃ®te mail
2. Cliquez sur le lien de vÃ©rification
3. Ou testez directement : `GET http://localhost:5000/api/auth/verify-email/TOKEN`

### 3. Tests d'erreurs

```json
// Email invalide
{
  "username": "Test",
  "email": "email-invalide",
  "password": "TestPass123!"
}

// Mot de passe faible
{
  "username": "Test",
  "email": "test@example.com",
  "password": "123"
}

// Champs manquants
{
  "username": "Test"
}
```

## ğŸ“ Structure du projet

```
back-end/
â”œâ”€â”€ controllers/
â”‚   â””â”€â”€ authController.js      # Logique d'authentification
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ User.js               # ModÃ¨le utilisateur
â”‚   â”œâ”€â”€ Programme.js          # ModÃ¨le programme sportif
â”‚   â”œâ”€â”€ Exercice.js           # ModÃ¨le exercice
â”‚   â””â”€â”€ Progression.js        # ModÃ¨le suivi progression
â”œâ”€â”€ routes/
â”‚   â””â”€â”€ authRoutes.js         # Routes d'authentification
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ email.js              # Service d'envoi d'emails
â”‚   â””â”€â”€ verifyPW.js           # Validation mot de passe
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ exercices.json        # DonnÃ©es exercices (Ã  complÃ©ter)
â”‚   â””â”€â”€ programmes.json       # DonnÃ©es programmes (Ã  complÃ©ter)
â”œâ”€â”€ .env                      # Variables d'environnement
â”œâ”€â”€ app.js                    # Configuration serveur
â””â”€â”€ package.json              # DÃ©pendances
```

## ğŸ›¡ï¸ SÃ©curitÃ©

- âœ… Hachage bcrypt des mots de passe
- âœ… Validation stricte des entrÃ©es
- âœ… Protection CORS activÃ©e
- âœ… VÃ©rification email obligatoire
- âœ… Tokens JWT avec expiration
- âœ… Sanitisation des donnÃ©es

## ğŸ”„ Prochaines Ã©tapes

1. ImplÃ©menter la fonction `login`
2. CrÃ©er middleware d'authentification
3. DÃ©velopper les routes programmes/exercices
4. Ajouter systÃ¨me de reset mot de passe
5. CrÃ©er le frontend React

## ğŸ› Debug

Pour voir les logs dÃ©taillÃ©s, activez le mode debug dans `authController.js` en ajoutant des `console.log()`.

---

**Auteur :** Ewen Larrieu  
**Version :** 1.0.0
